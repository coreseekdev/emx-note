-- tmp-test.txt --
# Test Note

# Test tag/label commands
env EMX_NOTE_HOME=$WORK/.emx-notes
env EMX_AGENT_NAME=

# Create a capsa first
exec emx-note --home $WORK/.emx-notes -g capsa create test-tag
stdout 'Created capsa: test-tag'

# Create a test note using note command
exec emx-note --home $WORK/.emx-notes -c test-tag note test-note < $WORK/tmp-test.txt

# Add note to tag
exec emx-note --home $WORK/.emx-notes -c test-tag tag add important test-note
stdout 'test-note'
stdout '#important'

# List tags
exec emx-note --home $WORK/.emx-notes -c test-tag tag list
stdout 'important'

# List notes in tag
exec emx-note --home $WORK/.emx-notes -c test-tag tag list important
stdout 'Test Note'

# Verify tag file exists using ls (in root directory now, not note/)
exec ls $WORK/.emx-notes/test-tag/
stdout '#important.md'

# Remove note from tag
exec emx-note --home $WORK/.emx-notes -c test-tag tag remove important test-note
stdout 'Removed'

# Verify tag file is deleted - list should not contain #important.md
exec ls $WORK/.emx-notes/test-tag/
! stdout '#important.md'
